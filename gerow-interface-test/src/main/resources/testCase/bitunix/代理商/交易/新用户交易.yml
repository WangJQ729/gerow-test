name: 新用户交易
story: trade
invocationCount: 1
dataProvider:
  - email: gerow${__time()}@bitunix.com
    password: Aa123456
    partner_email: gerow1@qq.com
    partner_password: Aa123456
    symbol: BTCUSDT
    amount: 0.16
    side: 2
beforeClass:
  name: 注册用户
  step:
    - keyWord: 登录partners
    - keyWord: 获取合伙人邀请码
    - keyWord: 快捷注册
    - keyWord: 增加合约账户资产
    - keyWord: 通过uid获取用户token
testMethod:
  - name: 用户市价开仓
    step:
      - keyWord: 市价开仓
      - keyWord: 持有仓位信息
      - keyWord: U本位合约历史委托
      - keyWord: 直客佣金查询
        intervals: 10000
        untilWait: 300
        assertion:
          - json:
              $.result.items[0].makerFee: ${openDealFee}
            assertionType: EIGHTDECIMALPLACES
      - keyWord: 市价平仓
      - keyWord: U本位合约历史委托-平仓
      - keyWord: 直客佣金查询
        intervals: 10000
        untilWait: 300
        assertion:
          - json:
              $.result.items[0].makerFee: ${__BeanShell(${makerFee} + ${closeDealFee})}
            assertionType: EIGHTDECIMALPLACES
  - name: 用户成为合伙人市价开仓
    step:
      - keyWord: 升级为合伙人
      - keyWord: 市价开仓
      - keyWord: 持有仓位信息
      - keyWord: U本位合约历史委托
      - keyWord: 直客佣金查询
        intervals: 10000
        untilWait: 300
        assertion:
          - json:
              $.result.items[0].makerFee: ${openDealFee}
            assertionType: EIGHTDECIMALPLACES
      - keyWord: 市价平仓
      - keyWord: U本位合约历史委托-平仓
      - keyWord: 直客佣金查询
        intervals: 10000
        untilWait: 300
        assertion:
          - json:
              $.result.items[0].makerFee: ${__BeanShell(${makerFee} + ${closeDealFee})}
            assertionType: EIGHTDECIMALPLACES
