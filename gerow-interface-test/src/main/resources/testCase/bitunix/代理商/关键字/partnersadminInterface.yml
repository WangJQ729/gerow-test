keyWord:
  step:
    - name: 登录partnersadmin
      host: ${partnersadmin_host}
      url: /partner/root/login
      method: POST
      body: |
        {"password":"${__digest(MD5,${partnersadmin_password})}","account":"${partnersadmin_account}"}
      extractor:
        - json:
            partnersadmin_token: $.result.token
    - name: 获取BD列表
      host: ${partnersadmin_host}
      url: /partner/root/bdList
      headers:
        Token: ${partnersadmin_token}
      method: GET
      extractor:
        - json:
            bd_uid: $.result[?(@.nickName=='${bd_name}')].uid
    - name: 获取用户信息
      host: ${partnersadmin_host}
      url: /partner/root/getUserInfoByUid/${userId}
      headers:
        Token: ${partnersadmin_token}
      method: GET
      extractor:
        - json:
            nickName: $.result.nickname
    - name: 新增合伙人
      host: ${partnersadmin_host}
      url: /partner/root/add
      headers:
        Token: ${partnersadmin_token}
      method: POST
      body: |
        {"uid":${userId},"futureRatio":95,"exchangeRatio":95,"nickName":"${nickName}","bdUid":${bd_uid}}
    - name: 佣金发放查询
      host: ${partnersadmin_host}
      url: /partner/root/rebate/statistics/list
      method: GET
      headers:
        Token: ${partnersadmin_token}
      variables:
        showBelow: true
        partnerInfo: ${partnerInfo}
        page: 1
        pageSize: 10
      extractor:
        - json:
            tradeAmount: $.result.items[?(@.symbol=='${symbol}')].tradeAmount
            realFee: $.result.items[?(@.symbol=='${symbol}')].realFee
            fee: $.result.items[?(@.symbol=='${symbol}')].fee
            userRebate: $.result.items[?(@.symbol=='${symbol}')].userRebate
            partnerRebate: $.result.items[?(@.symbol=='${symbol}')].partnerRebate
    - name: 合伙人列表
      host: ${partnersadmin_host}
      url: /partner/root/page
      headers:
        Token: ${partnersadmin_token}
      method: POST
      body: |
        {"page":1,"pageSize":10,"uid":"${partner_uid}","registerStart":"","registerEnd":"","pageIndex":1}
      extractor:
        - json:
            totalExchangeRatio: $.result.items[0].exchangeRatio
            totalFutureRatio: $.result.items[0].futureRatio
    - name: 变更BD
      host: ${partnersadmin_host}
      url: /partner/root/change_bd
      headers:
        Token: ${partnersadmin_token}
      method: POST
      body: |
        {"bdUid":284,"uid":${partner_uid}}
      assertion: [json: {$.code: '0'}]