name: 字段校验
story: 审批流程
dataProvider:
  - audit_type: deal_new
beforeClass:
  name: 前置条件设置
  step:
    - byName: 获取审批节点id-新签审批
    - byName: 获取所有角色列表
    - byName: 配置审批节点-直接主管审批
    - byName: 随机获取销售和销售主管
    - byName: 获取类目列表
testMethod:
  - name: 参数校验
    description: |
      """</br>
      参数校验
      """
    severity: NORMAL
    step:
      - byName: 创建合同
        extractor:
          - json:
              code_id: $.code
    editor:
      - name: 销售不存在
        json: {$.info.owner_info.sale_name: "${__RandomName(new_sale_name)}"}
        assertion: [json: {"$.message": "销售 ${new_sale_name} 不存在"}]
      - name: 销售主管不存在
        json: {$.info.owner_info.sale_super_name: "${__RandomName(new_sale_super_name)}"}
        assertion: [json: {"$.message": "销售主管 ${new_sale_super_name} 不存在"}]
#      - name: 销售为空
#        json: {$.info.owner_info.sale_name: ~}
#        assertion: [json: {"$.message": "销售不能为空"}]
#      - name: 销售主管为空
#        json: {$.info.owner_info.sale_super_name: ~}
#        assertion: [json: {"$.message": "销售主管不能为空"}]
#      - name: 公司名称为空
#        json: {$.info.company_info.v2_company_name: ~}
#        assertion: [json: {"$.message": "公司名称不能为空"}]
#      - name: 公司名称很长
#        json: {$.info.company_info.v2_company_name: "${__RandomString(30,zxcvbnmlkjhgfdsaqwertyuiopQWERTYUIOPASDFGHJKLZXCVBNM1234567890,)}"}
#        assertion: [json: {"$.message": "公司名称不能为空"}]
#      - name: 手机号格式错误
#        json: {$.info.company_info.v2_kp_phone: "0${__RandomString(10,1234567890,)}"}
#        assertion: [json: {"$.message": "手机号格式错误"}]
      - name: 子账号手机号格式
        json:
          $.info.customers[0].sub_nicks[0].phone: ~
        assertion: [json: {"$.message": "手机号格式错误"}]