name: 登录mp后台
testMethod:
  - name: 登录mp后台
    step:
      - name: 获取MP后台地址
        url: /api/auth/mp_switcher
        variables:
          subnick: ${shopName}
        method: GET
        assertion:
          - json:
              $.code: 0
        extractor:
          - json:
              auth_url: $.url
      - name: 进入主页
        host: ""
        url: ${auth_url}
        method: GET
        responseType: DEFAULT
      - name: 获取shop_id
        url: /api/admin/user/logined
        method: GET
        extractor:
          - json:
              shop_id: $.user.shop_id
              shop_category_id: $.default_shop.category_id
            site: TESTSUIT
        assertion: [json: {$.code: 0}]
      - name: 获取子账号
        url: /api/admin/platform/search_client_configs_v3
        variables:
          limit: 20
          skip: 0
          only_supplier: false
        method: GET
        extractor:
          - json:
              seller_name: $.subusers[?(@.auth_status==0)].sub_nick[0]
              child_seller: $.subusers[?(@.auth_status==1)].sub_nick[0]
              child_seller2: $.subusers[?(@.auth_status==1)].sub_nick[1]
              child_seller3: $.subusers[?(@.auth_status==1)].sub_nick[2]
              child_seller4: $.subusers[?(@.auth_status==1)].sub_nick[3]
        assertion: [json: {$.code: 0}]
      - byName: 获取子账号