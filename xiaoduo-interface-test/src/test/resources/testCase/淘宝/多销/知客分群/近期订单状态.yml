name: 近期订单状态
dataProvider:
    - order_state: created
      order_state_name: 已下单
    - order_state: deposited
      order_state_name: 已付定金
    - order_state: paid
      order_state_name: 已付款
    - order_state: succeeded
      order_state_name: 交易成功
    - order_state: closed
      order_state_name: 订单取消
testMethod:
  - name: 已下单分群-${order_state_name}
    step:
      - byName: 新建顾客分群
        name: 新建已下单顾客分群-近期订单状态
        bodyEditor:
          json:
            $.customer_group.cond.select_cond.child_conds[0].child_conds[0].cond.type: last_order_state
            $.customer_group.cond.select_cond.child_conds[0].child_conds[0].cond.rule.type: last_order_state
            $.customer_group.cond.select_cond.child_conds[0].child_conds[0].cond.rule.state: ${order_state}
            $.customer_group.cond.select_cond.child_conds[0].child_conds[0].cond.rule.min_time: ${__BeanShell(${__time(/1000)},)}
            $.customer_group.cond.select_cond.child_conds[0].child_conds[0].cond.rule.max_time: ${__BeanShell(${__time(/1000)}+600,)}
      - byName: 查看分群列表-获取新分群ID
      - byName: 获取初始化后的客群人数
      - byName: 通过pulsar推送订单消息-随机顾客
      - byName: 校验客群人数增加
afterMethod:
  name: 删除智能分群
  step:
    - byName: 删除智能分群